/Users/linchuan/opt/anaconda3/bin/python /Users/linchuan/JHU-ML/introML-A3/Example3_WeightUpdate.py
House Dataset
The original dataset is:
             0  1  2  3  4  5  6  7  8  9  10 11 12 13 14 15 16
0    republican  n  y  n  y  y  y  n  n  n  y  ?  y  y  y  n  y
1    republican  n  y  n  y  y  y  n  n  n  n  n  y  y  y  n  ?
2      democrat  ?  y  y  ?  y  y  n  n  n  n  y  n  y  y  n  n
3      democrat  n  y  y  n  ?  y  n  n  n  n  y  n  y  n  n  y
4      democrat  y  y  y  n  y  y  n  n  n  n  y  ?  y  y  y  y
..          ... .. .. .. .. .. .. .. .. .. .. .. .. .. .. .. ..
430  republican  n  n  y  y  y  y  n  n  y  y  n  y  y  y  n  y
431    democrat  n  n  y  n  n  n  y  y  y  y  n  n  n  n  n  y
432  republican  n  ?  n  y  y  y  n  n  n  n  y  y  y  y  n  y
433  republican  n  n  n  y  y  y  ?  ?  ?  ?  n  y  y  y  n  y
434  republican  n  y  n  y  y  y  n  n  n  y  n  y  y  y  ?  n

[435 rows x 17 columns]


The processed dataset is:
     0         1         2         3   ...        13        14        15        16
0     1 -0.904742  1.051709 -1.224976  ...  1.010112  0.850601 -0.901484  0.716114
1     1 -0.904742  1.051709 -1.224976  ...  1.010112  0.850601 -0.901484 -0.650156
2     0  0.114851  1.051709  0.836395  ...  1.010112  0.850601 -0.901484 -2.016426
3     0 -0.904742  1.051709  0.836395  ...  1.010112 -1.222292 -0.901484  0.716114
4     0  1.134444  1.051709  0.836395  ...  1.010112  0.850601  1.184397  0.716114
..   ..       ...       ...       ...  ...       ...       ...       ...       ...
430   1 -0.904742 -1.066316  0.836395  ...  1.010112  0.850601 -0.901484  0.716114
431   0 -0.904742 -1.066316  0.836395  ... -1.047962 -1.222292 -0.901484  0.716114
432   1 -0.904742 -0.007304 -1.224976  ...  1.010112  0.850601 -0.901484  0.716114
433   1 -0.904742 -1.066316 -1.224976  ...  1.010112  0.850601 -0.901484  0.716114
434   1 -0.904742  1.051709 -1.224976  ...  1.010112  0.850601  0.141456 -2.016426

[435 rows x 17 columns]


the class labels are: [-1.01628825 -0.00926003  0.99776819]
the shape of df is  (435, 17)
The input size is 16
The output size is 4
The learning rate is 0.001
The epoch number is 1
The batch size is 50


The hidden size for FNN are 20 and 10
5
The hidden size for Autoencoder are 10 and 20





the data point is:
0     0.000000
1     1.134444
2     1.051709
3     0.836395
4    -0.860424
5    -1.025922
6    -1.344366
7     0.890212
8     0.876857
9     1.022755
10   -1.016288
11   -0.784377
12   -0.898620
13   -1.047962
14   -1.222292
15    1.184397
16    0.716114
Name: 69, dtype: float64





The is LM
in layer 0
this is Linear layer
before update, the params are
[[-0.39268068 -1.2937472  -0.60355009  0.08398933 -0.57897847  2.6237901
   0.51294056  0.78503497 -0.54053486  0.12227733 -1.24405387 -0.4512333
   0.69353372 -1.7851522  -0.9722962  -0.97023845]
 [-0.24437406  0.76928077  2.35263451 -0.54066148  1.47051347 -0.41351174
  -0.41996329  2.17910355  0.1230186  -2.18613049 -0.16089366 -1.72294045
  -0.22165808 -0.42269288 -1.3689189   1.10531248]
 [-0.71400702  0.04107476  0.33545397  0.58023959  1.18760241  0.07344084
  -0.87122926 -1.32648592 -2.30283613  2.19206238  2.18277379 -0.82700742
   1.64647254 -0.45819981  0.01023242 -0.27184285]
 [-0.95339309 -0.40149549 -0.91674064 -0.51173213 -0.82952371 -0.45983556
   0.39443231  1.18990355  0.83369889 -1.43292135  0.03653207  0.61203302
  -0.9737274   0.7044587   0.16922635 -0.16230185]]
[[-0.23483582]
 [ 0.84399055]
 [-0.80009966]
 [-1.72563464]]
before update, the grads are
[[-14.75618002   1.42151981 -22.41916854  28.88981575  20.92340017
   18.09751276 -12.47453839 -17.55213769 -14.65051605   4.08357567
   -8.49976482  23.77271598  14.61458305  14.36698856 -15.22595111
   -9.98798861]
 [ 22.19713934  -4.98966879  36.57427688 -40.47713118 -33.12141206
  -25.92290557  22.81404047  31.72386291  26.14362153  -8.34113045
   15.52159248 -37.45628767 -26.23470625 -27.44566894  23.93368568
   13.17532253]
 [ -9.18081689   7.24766846 -12.44625316  12.10878753  14.66024494
   11.144391   -13.32471127 -17.18227787 -14.97983173   2.91364524
   -5.38114422  15.342916    13.00892184  12.25886648 -10.29650495
   -5.43746616]
 [  1.73985757  -3.67951948  -1.70885517  -0.5214721   -2.46223305
   -3.31899819   2.98520919   3.01055266   3.48672624   1.34390954
   -1.64068344  -1.65934431  -1.38879864   0.81981391   1.58877038
    2.25013224]]
[[-16.4676799 ]
 [ -2.60064139]
 [ 15.38885581]
 [  3.67946548]]
after update, the params are
[[-0.3779245  -1.29516872 -0.58113092  0.05509952 -0.59990187  2.60569259
   0.5254151   0.80258711 -0.52588434  0.11819375 -1.23555411 -0.47500602
   0.67891914 -1.79951919 -0.95707025 -0.96025046]
 [-0.2665712   0.77427044  2.31606023 -0.50018435  1.50363488 -0.38758883
  -0.44277733  2.14737969  0.09687498 -2.17778936 -0.17641525 -1.68548416
  -0.19542338 -0.39524721 -1.39285259  1.09213715]
 [-0.7048262   0.0338271   0.34790022  0.5681308   1.17294216  0.06229645
  -0.85790455 -1.30930364 -2.2878563   2.18914874  2.18815494 -0.84235034
   1.63346362 -0.47045868  0.02052892 -0.26640538]
 [-0.95513295 -0.39781597 -0.91503178 -0.51121066 -0.82706147 -0.45651656
   0.3914471   1.186893    0.83021216 -1.43426526  0.03817275  0.61369237
  -0.97233861  0.70363889  0.16763758 -0.16455198]]
[[-0.21836814]
 [ 0.84659119]
 [-0.81548851]
 [-1.7293141 ]]
















The is FNN
in layer 0
this is Linear layer
before update, the params are
[[ 4.66053349e-02 -1.34997359e+00  1.71162379e+00 -5.25551530e-01
   8.01978745e-01 -1.82948005e+00 -2.88482485e-01 -1.31897247e+00
  -1.07979692e+00 -1.64635733e+00 -4.11589735e-01  3.74017132e-01
  -3.88772099e-01 -3.74304384e-01 -3.27508801e-01 -7.02212071e-01]
 [ 1.18574536e+00  4.11593167e-01 -5.27336835e-01 -7.00574085e-01
   1.00336268e+00  6.38678806e-01 -3.12807250e-03 -6.86813542e-02
  -1.94241283e+00 -2.21705618e-01  4.01584398e-02 -3.40389855e-01
  -1.42520189e-01  2.33253792e-01  1.03002858e+00  1.11461620e+00]
 [-5.76060491e-01 -5.26251208e-01 -1.11520536e+00  3.26707454e-01
  -1.30505335e-01  1.36392204e+00 -2.34641965e+00  7.68690207e-01
  -3.36636210e-01  1.01797693e-01 -2.49961297e+00 -6.31806445e-03
   2.42401179e+00  8.44406826e-01 -6.60594211e-01  1.43520205e+00]
 [-3.02894516e-01  1.02025004e+00 -2.35722147e-01  9.17684605e-01
   1.82283729e-01  6.88151781e-01 -1.20513498e+00  6.21133242e-01
   4.22551912e-01 -7.28016688e-01 -1.28236664e+00  1.37953525e+00
   5.07297003e-01  8.24801296e-01 -5.01684420e-01 -2.19572960e+00]
 [-1.59912733e+00 -3.58260074e-01  2.19045999e+00 -1.93003308e-01
   1.77071688e+00 -1.42645169e+00  1.89613458e-03 -1.43139482e-01
  -1.30147108e+00  1.49703125e-01 -2.43089256e-01 -7.15705055e-01
   4.53539781e-01  1.06569358e+00  3.41610870e-01 -9.60798340e-01]
 [ 2.29943955e-01 -3.16237328e-01  9.03781654e-01 -1.07217717e+00
   3.08888226e-02  9.61203702e-01  1.37323174e+00 -9.84927965e-01
   1.95073587e+00  5.71532292e-01  1.16946776e+00 -5.22559961e-01
  -8.17971615e-01 -9.35046012e-01 -6.96732650e-01  1.61680128e+00]
 [-1.43868880e-01 -5.01416262e-01 -4.15470377e-02 -9.69514221e-01
   2.65113568e-01 -1.20551463e+00  6.16401888e-02 -2.58715418e-01
  -1.41705647e+00  1.92886088e-01  9.12385345e-01  7.57005234e-01
  -2.41321091e-01 -1.16493665e-01  5.75952657e-01 -2.82405085e-01]
 [-1.16470216e+00 -1.56761027e-01 -3.02989913e-02 -5.25514708e-02
   7.48809788e-01 -3.19281203e-01  6.83422535e-01 -4.03589325e-01
   5.13019556e-01 -1.83692175e+00 -8.48756476e-01 -4.35818775e-02
   1.87150653e+00  5.11081236e-01  3.79204394e-01 -1.30390342e+00]
 [ 2.17151277e-01 -5.76526419e-01 -1.63345129e+00  7.27660247e-01
  -1.37153926e-02  1.18607668e+00 -1.37789268e+00 -1.15993308e+00
  -1.72760696e+00  2.37952058e-01  3.89663483e-01  3.49791261e-01
   3.86563563e-01 -1.33961243e+00  1.22250943e+00  9.94833522e-01]
 [ 1.38111892e-01 -1.40203995e-01 -1.87959972e+00 -1.28593007e-01
  -2.45629305e-01 -7.32330964e-01 -7.64628716e-01 -1.03990411e-01
   4.13811400e-01 -2.81503656e-01  7.86764356e-01 -7.84971668e-02
   7.80473381e-01 -5.47322381e-01 -1.56984375e+00 -1.44491630e+00]
 [ 5.71690264e-01 -7.14694087e-02 -2.06476452e-01 -1.48896967e+00
   8.74550283e-01 -7.60335425e-01  6.79022369e-01 -3.20113480e-01
  -1.12631588e+00 -8.59791127e-01 -6.83173310e-01 -2.06196492e+00
   1.23395175e-01  1.43190208e+00 -1.21343954e+00 -1.19165759e+00]
 [-6.35399564e-01 -2.56927871e+00 -1.30753916e-01  9.13686733e-01
   2.25590060e+00 -1.26726854e+00 -1.67658501e+00 -1.38664965e+00
  -4.10828951e-02 -7.56485161e-01  1.01419865e+00  1.93879764e-01
   8.77877008e-01 -1.65583046e+00  9.33586505e-01  9.14776501e-01]
 [ 4.11454346e-01 -2.05656519e-01 -2.08152515e-01  1.13387924e+00
  -2.28880326e+00  1.39925914e-01 -1.38176507e+00  5.99829758e-01
   2.08396958e+00  9.09730201e-01  1.70713028e+00  7.46019177e-01
   1.14683388e+00  6.23041528e-01 -1.56611172e+00  1.18148665e+00]
 [-8.35760978e-01 -9.10591368e-02 -3.93945875e-01  2.29269973e+00
   7.40868774e-01 -1.73812605e+00 -6.05671502e-01 -1.14178049e-02
   1.86338508e-01 -5.37821710e-01  1.72342549e+00 -6.77564997e-01
  -1.00854490e+00 -5.60574472e-01 -2.16659212e+00 -2.56350444e-01]
 [-9.67283185e-01  1.35071884e+00  2.69466135e-01 -1.45811514e-01
  -2.21976893e+00 -1.56100898e-01 -1.56083621e-01 -2.06152769e-01
   7.41098143e-01  1.23998711e-01  2.53980637e-01 -3.65427328e-01
   1.15556491e+00 -1.00404973e+00 -4.46141680e-01  6.69089379e-01]
 [-8.70991955e-01 -4.82727705e-01 -7.45168440e-01 -1.62151670e-01
  -3.53707156e-01  3.21660321e-01  4.26889121e-01 -9.26111264e-01
   5.54741039e-01 -4.02805501e-01 -1.32131956e+00  6.53261544e-01
   3.79458148e-01 -6.52969511e-01 -5.85713762e-01 -6.05232767e-01]
 [ 9.07122169e-01 -1.86157878e-01 -9.90234513e-01 -7.99510756e-01
  -1.02375085e+00  2.18740302e+00 -1.83523340e-01  2.29438372e-01
   1.66159667e+00 -1.40285982e+00 -3.52410872e-01  3.89524030e-01
   3.04640943e-02  3.13831243e-02 -1.18710432e-01 -4.67275680e-01]
 [-8.11870417e-01 -2.18280333e-01  9.80330080e-01 -1.01804053e-01
   2.22914944e-01 -1.53790457e+00 -1.88582771e+00 -2.10515452e-02
   8.73425914e-01  8.78308074e-01  1.01826958e-01 -1.31783492e+00
   1.24101171e+00  1.51076275e+00  8.28204234e-02 -1.46136527e+00]
 [-7.10767058e-01 -5.29646831e-01 -6.94089251e-01 -2.27803717e-01
   6.95791505e-01 -2.93311879e-01 -1.35763616e+00 -1.67853187e+00
   1.60525554e-01  9.95164847e-01  6.43695895e-01 -9.39564523e-01
  -4.11674575e-02 -3.32027813e-01  2.25648180e+00 -1.35913066e+00]
 [-4.99524592e-01 -5.85628810e-02  6.89885579e-01  9.22669196e-01
  -2.33689191e-01  3.43189704e-01 -1.24137494e-01 -1.70656755e-01
   1.11854885e+00  5.65330051e-02  1.50847506e+00 -1.44674930e+00
   7.77694923e-01 -2.00888712e-02 -7.04695217e-01 -1.23402555e+00]]
[[-0.6749863 ]
 [-0.85751341]
 [-0.19687483]
 [-2.03266902]
 [ 0.89827023]
 [-1.00940614]
 [ 0.25815588]
 [ 0.71700045]
 [ 0.25126131]
 [-0.60173817]
 [-0.388552  ]
 [-1.50384422]
 [-0.57260795]
 [-1.64798439]
 [-0.47951981]
 [-1.89909548]
 [-2.04170964]
 [ 0.64824235]
 [ 1.47420819]
 [ 1.00118416]]
before update, the grads are
[[ 9.52357126e-01 -5.20428648e-01  1.50385583e+00 -1.92420194e+00
  -1.53165141e+00 -1.00108296e+00  1.00047110e+00  1.34403001e+00
   8.03797525e-01  5.02793128e-02  1.14950533e+00 -1.23954008e+00
  -1.19521699e+00 -9.20574170e-01  1.56587724e+00  1.27540251e+00]
 [-6.72009449e-02  1.73981713e-02  2.94275354e-01 -8.36783911e-02
  -8.01916030e-02 -2.15921041e-01  6.29847301e-02  6.59021472e-02
   4.50778385e-02 -3.56520927e-01 -8.97607413e-03 -5.52128677e-02
  -1.81665018e-01 -2.41294821e-01  6.49528128e-02  3.05840946e-01]
 [ 7.55070287e-02 -4.67067916e-01  2.15744485e-01 -8.40155332e-01
  -6.42497469e-01  3.71749131e-01  3.80619849e-01  4.44890787e-01
   5.25218127e-01  4.39832401e-01  1.33000935e-03 -2.86609637e-01
  -3.15717633e-01  1.66567410e-01  2.64385254e-02  6.31115025e-01]
 [-1.46757360e-01  1.45365037e-01  6.53876226e-02 -1.84236257e-01
  -3.12745003e-02  1.43052266e-01 -7.33221033e-02 -6.35788073e-03
   4.77771399e-02  5.32993396e-02 -3.06530116e-02 -2.08208989e-02
   1.88505345e-01  9.72392345e-02 -2.38760823e-02  8.59926953e-02]
 [ 6.90805219e-01 -3.47032478e-01  1.05329647e+00 -1.23145434e+00
  -9.92611693e-01 -7.07935139e-01  5.79810557e-01  7.73742340e-01
   6.58751120e-01  4.79026826e-02  2.73600440e-01 -1.04689174e+00
  -7.80627724e-01 -6.34920271e-01  7.29652874e-01  1.39390909e-01]
 [ 9.52897131e-02 -2.39348721e-01  1.06048861e+00 -1.09678521e+00
  -1.16073319e+00 -1.34597708e+00  2.29781853e-02  8.91657790e-01
   9.90278246e-01 -8.49773144e-01 -1.45306922e-01 -9.95229892e-01
  -9.62780733e-01 -2.85864485e-01  8.58152135e-01  3.46004946e-02]
 [ 2.49774496e-01 -5.25601717e-01  1.72054486e-01 -3.87871994e-01
  -4.96937620e-01 -5.72364158e-01  2.29054748e-01  3.66337374e-01
   4.17717836e-01 -1.51775866e-01 -3.77984967e-01 -3.32693630e-01
  -3.43035191e-01 -3.35843673e-01  3.51821003e-01 -8.94695905e-02]
 [-8.56033752e-01  4.31369933e-01 -1.93911163e+00  2.17448013e+00
   2.12246549e+00  1.48316332e+00 -7.14038795e-01 -1.99561557e+00
  -1.92076396e+00  9.03429318e-01  4.80901465e-02  2.08569800e+00
   1.14517541e+00  1.10006435e+00 -8.63060285e-01 -3.15329019e-01]
 [-1.99191640e-01 -3.06495538e-03 -6.72642135e-02  2.29311463e-01
   2.51739039e-01  5.40671136e-02 -1.43864559e-01 -1.45099536e-01
  -6.87946149e-02 -3.86524930e-04 -1.50726089e-01  8.38725309e-02
   1.86997629e-01  9.43424857e-02 -1.59432244e-01 -2.55065750e-01]
 [ 4.62542062e-01 -7.28334838e-02  4.49131268e-01 -6.65686388e-01
  -6.95751055e-01 -4.47794115e-01  1.54956608e-01  7.02078416e-01
   8.01955555e-01  5.41871245e-02 -3.42900875e-01 -6.74179561e-01
  -4.83909415e-02 -4.00804987e-01 -1.40511184e-01  3.36312580e-01]
 [-5.25272433e-01 -4.96186415e-02 -5.45470388e-01  9.58547404e-01
   9.47443754e-01  3.69728443e-01 -4.92336575e-01 -7.64175298e-01
  -5.84233231e-01 -4.47624524e-01 -8.02314429e-02  8.12960361e-01
   3.68000742e-01  3.71677078e-01 -3.64091909e-01 -6.18059384e-01]
 [-1.28950512e+00  1.37112121e+00 -1.90247534e+00  2.26215732e+00
   1.90501684e+00  1.40592129e+00 -8.59495482e-01 -1.45747487e+00
  -1.22419066e+00  2.18973437e-01 -7.88224375e-01  1.35564167e+00
   1.59345229e+00  1.81302217e+00 -1.40462266e+00 -8.57979804e-01]
 [ 2.20704081e+00 -2.25373340e+00  2.25999834e+00 -3.10476285e+00
  -2.98632635e+00 -2.40391575e+00  2.70228324e+00  2.80639181e+00
   2.54674035e+00 -1.11434670e-01 -8.27439542e-02 -2.95094091e+00
  -2.45388017e+00 -2.04043531e+00  1.87927600e+00  1.92314307e+00]
 [-2.66674434e-01 -5.91420113e-03 -2.90457772e-01  2.85617986e-01
   2.00847118e-01  2.28148604e-01 -2.15493691e-01 -1.91931346e-01
  -1.56510157e-01 -2.00520367e-01 -1.54755625e-01  2.97295189e-01
  -4.39311889e-02  2.74913942e-01  1.58639536e-01 -3.97169259e-02]
 [ 2.46335488e-01 -1.03605551e-03 -9.17339104e-02 -1.88584917e-01
   4.47895890e-02  3.78612819e-01 -1.23528283e-01  1.08812163e-01
   6.16330743e-02  6.78283737e-01  9.86909730e-01  6.96863972e-02
   6.69266930e-02  2.69700258e-01  1.57905197e-01  3.91297645e-01]
 [-5.61863567e-01  8.97328832e-01 -1.25991921e+00  1.52006917e+00
   1.22818021e+00  1.00929720e+00 -1.01043026e+00 -1.10935445e+00
  -1.00681537e+00  6.80273836e-01  3.41654866e-01  1.20758227e+00
   1.03349236e+00  8.90789996e-01 -4.93706309e-01 -6.12091751e-01]
 [-1.32476449e+00  1.31517581e+00 -1.93144846e+00  2.55003806e+00
   2.49062943e+00  1.70690944e+00 -1.17172565e+00 -2.07062163e+00
  -1.83537287e+00  5.85059828e-01  5.04829746e-01  2.08457874e+00
   1.83318645e+00  1.58902365e+00 -7.69787764e-01 -2.55887103e-01]
 [-1.08382813e+00  1.29307816e+00 -1.12025745e+00  1.18187251e+00
   1.54749383e+00  1.49990769e+00 -1.27056262e+00 -1.29634037e+00
  -1.41801750e+00  3.51555008e-02  5.81840053e-01  1.26955077e+00
   1.09616542e+00  1.47210516e+00 -1.08213323e+00 -3.68568022e-01]
 [-4.50830102e-01  2.44573582e-01 -4.85729362e-01  6.15851894e-01
   5.06964905e-01  3.50077274e-01 -2.57681711e-01 -4.14753495e-01
  -3.67839772e-01 -7.46870793e-02 -3.56787127e-01  4.41837177e-01
   4.39992299e-01  2.71803054e-01 -3.79895010e-01  4.24672893e-02]
 [-2.52798269e+00  1.37070172e+00 -3.11495495e+00  3.62666429e+00
   3.39778826e+00  2.38130877e+00 -2.44776661e+00 -2.79063514e+00
  -2.02807123e+00  1.82178557e-01 -1.33814056e+00  2.93263724e+00
   2.96861654e+00  2.38996623e+00 -1.84892659e+00 -1.66420316e+00]]
[[ 0.32293741]
 [-0.67314261]
 [ 0.67114378]
 [ 0.10837969]
 [ 0.36962164]
 [ 1.11399861]
 [ 1.12870134]
 [-1.67635359]
 [-0.0849161 ]
 [ 1.3852132 ]
 [-1.06132007]
 [-0.31338375]
 [ 1.23882875]
 [-0.20086803]
 [-0.85343848]
 [-0.41465361]
 [-2.39163215]
 [-1.76494073]
 [-0.08409498]
 [-0.85085792]]
after update, the params are
[[ 4.56529777e-02 -1.34945316e+00  1.71011993e+00 -5.23627328e-01
   8.03510397e-01 -1.82847897e+00 -2.89482956e-01 -1.32031650e+00
  -1.08060072e+00 -1.64640761e+00 -4.12739240e-01  3.75256672e-01
  -3.87576882e-01 -3.73383810e-01 -3.29074678e-01 -7.03487474e-01]
 [ 1.18581256e+00  4.11575769e-01 -5.27631110e-01 -7.00490406e-01
   1.00344287e+00  6.38894727e-01 -3.19105723e-03 -6.87472564e-02
  -1.94245791e+00 -2.21349097e-01  4.01674159e-02 -3.40334643e-01
  -1.42338524e-01  2.33495087e-01  1.02996363e+00  1.11431036e+00]
 [-5.76135998e-01 -5.25784140e-01 -1.11542111e+00  3.27547609e-01
  -1.29862837e-01  1.36355029e+00 -2.34680027e+00  7.68245317e-01
  -3.37161428e-01  1.01357860e-01 -2.49961430e+00 -6.03145481e-03
   2.42432750e+00  8.44240258e-01 -6.60620650e-01  1.43457093e+00]
 [-3.02747759e-01  1.02010467e+00 -2.35787535e-01  9.17868841e-01
   1.82315004e-01  6.88008728e-01 -1.20506166e+00  6.21139600e-01
   4.22504134e-01 -7.28069987e-01 -1.28233599e+00  1.37955607e+00
   5.07108498e-01  8.24704057e-01 -5.01660544e-01 -2.19581559e+00]
 [-1.59981813e+00 -3.57913042e-01  2.18940669e+00 -1.91771854e-01
   1.77170949e+00 -1.42574375e+00  1.31632402e-03 -1.43913224e-01
  -1.30212983e+00  1.49655222e-01 -2.43362856e-01 -7.14658163e-01
   4.54320409e-01  1.06632850e+00  3.40881218e-01 -9.60937731e-01]
 [ 2.29848665e-01 -3.15997979e-01  9.02721166e-01 -1.07108038e+00
   3.20495558e-02  9.62549680e-01  1.37320876e+00 -9.85819623e-01
   1.94974559e+00  5.72382065e-01  1.16961307e+00 -5.21564731e-01
  -8.17008834e-01 -9.34760147e-01 -6.97590802e-01  1.61676668e+00]
 [-1.44118655e-01 -5.00890660e-01 -4.17190922e-02 -9.69126349e-01
   2.65610505e-01 -1.20494227e+00  6.14111341e-02 -2.59081755e-01
  -1.41747419e+00  1.93037864e-01  9.12763330e-01  7.57337928e-01
  -2.40978056e-01 -1.16157821e-01  5.75600836e-01 -2.82315615e-01]
 [-1.16384613e+00 -1.57192396e-01 -2.83598797e-02 -5.47259509e-02
   7.46687322e-01 -3.20764366e-01  6.84136574e-01 -4.01593709e-01
   5.14940320e-01 -1.83782518e+00 -8.48804566e-01 -4.56675755e-02
   1.87036136e+00  5.09981171e-01  3.80067455e-01 -1.30358809e+00]
 [ 2.17350468e-01 -5.76523354e-01 -1.63338403e+00  7.27430936e-01
  -1.39671316e-02  1.18602262e+00 -1.37774881e+00 -1.15978798e+00
  -1.72753816e+00  2.37952445e-01  3.89814209e-01  3.49707389e-01
   3.86376566e-01 -1.33970677e+00  1.22266886e+00  9.95088588e-01]
 [ 1.37649350e-01 -1.40131161e-01 -1.88004885e+00 -1.27927321e-01
  -2.44933554e-01 -7.31883170e-01 -7.64783673e-01 -1.04692490e-01
   4.13009444e-01 -2.81557843e-01  7.87107257e-01 -7.78229873e-02
   7.80521772e-01 -5.46921576e-01 -1.56970324e+00 -1.44525261e+00]
 [ 5.72215536e-01 -7.14197901e-02 -2.05930982e-01 -1.48992821e+00
   8.73602839e-01 -7.60705154e-01  6.79514706e-01 -3.19349304e-01
  -1.12573164e+00 -8.59343502e-01 -6.83093078e-01 -2.06277788e+00
   1.23027174e-01  1.43153040e+00 -1.21307544e+00 -1.19103953e+00]
 [-6.34110059e-01 -2.57064983e+00 -1.28851441e-01  9.11424576e-01
   2.25399558e+00 -1.26867446e+00 -1.67572551e+00 -1.38519218e+00
  -3.98587045e-02 -7.56704134e-01  1.01498687e+00  1.92524122e-01
   8.76283555e-01 -1.65764349e+00  9.34991128e-01  9.15634480e-01]
 [ 4.09247305e-01 -2.03402785e-01 -2.10412514e-01  1.13698400e+00
  -2.28581693e+00  1.42329830e-01 -1.38446735e+00  5.97023366e-01
   2.08142284e+00  9.09841636e-01  1.70721302e+00  7.48970118e-01
   1.14928776e+00  6.25081963e-01 -1.56799100e+00  1.17956350e+00]
 [-8.35494304e-01 -9.10532226e-02 -3.93655417e-01  2.29241411e+00
   7.40667927e-01 -1.73835420e+00 -6.05456009e-01 -1.12258736e-02
   1.86495018e-01 -5.37621190e-01  1.72358025e+00 -6.77862292e-01
  -1.00850097e+00 -5.60849386e-01 -2.16675076e+00 -2.56310727e-01]
 [-9.67529521e-01  1.35071988e+00  2.69557868e-01 -1.45622929e-01
  -2.21981372e+00 -1.56479511e-01 -1.55960093e-01 -2.06261581e-01
   7.41036510e-01  1.23320427e-01  2.52993727e-01 -3.65497015e-01
   1.15549799e+00 -1.00431943e+00 -4.46299585e-01  6.68698081e-01]
 [-8.70430091e-01 -4.83625034e-01 -7.43908521e-01 -1.63671739e-01
  -3.54935336e-01  3.20651024e-01  4.27899551e-01 -9.25001909e-01
   5.55747854e-01 -4.03485774e-01 -1.32166121e+00  6.52053962e-01
   3.78424655e-01 -6.53860301e-01 -5.85220056e-01 -6.04620676e-01]
 [ 9.08446934e-01 -1.87473053e-01 -9.88303064e-01 -8.02060794e-01
  -1.02624148e+00  2.18569611e+00 -1.82351615e-01  2.31508994e-01
   1.66343204e+00 -1.40344488e+00 -3.52915702e-01  3.87439451e-01
   2.86309078e-02  2.97941006e-02 -1.17940644e-01 -4.67019793e-01]
 [-8.10786589e-01 -2.19573412e-01  9.81450338e-01 -1.02985926e-01
   2.21367450e-01 -1.53940447e+00 -1.88455714e+00 -1.97552049e-02
   8.74843931e-01  8.78272918e-01  1.01245117e-01 -1.31910447e+00
   1.23991554e+00  1.50929065e+00  8.39025566e-02 -1.46099670e+00]
 [-7.10316227e-01 -5.29891405e-01 -6.93603522e-01 -2.28419569e-01
   6.95284541e-01 -2.93661957e-01 -1.35737848e+00 -1.67811712e+00
   1.60893394e-01  9.95239534e-01  6.44052682e-01 -9.40006360e-01
  -4.16074498e-02 -3.32299616e-01  2.25686169e+00 -1.35917313e+00]
 [-4.96996610e-01 -5.99335827e-02  6.93000534e-01  9.19042531e-01
  -2.37086979e-01  3.40808395e-01 -1.21689727e-01 -1.67866120e-01
   1.12057692e+00  5.63508266e-02  1.50981320e+00 -1.44968194e+00
   7.74726307e-01 -2.24788375e-02 -7.02846290e-01 -1.23236135e+00]]
[[-0.67530924]
 [-0.85684026]
 [-0.19754598]
 [-2.0327774 ]
 [ 0.89790061]
 [-1.01052014]
 [ 0.25702718]
 [ 0.7186768 ]
 [ 0.25134623]
 [-0.60312338]
 [-0.38749068]
 [-1.50353083]
 [-0.57384678]
 [-1.64778352]
 [-0.47866637]
 [-1.89868083]
 [-2.03931801]
 [ 0.6500073 ]
 [ 1.47429229]
 [ 1.00203502]]



in layer 1
this is Sigmoid layer
before update, the params are
before update, the grads are
after update, the params are



in layer 2
this is Linear layer
before update, the params are
[[ 0.62718918 -0.20961774 -0.61669593 -0.28417793  0.04495948 -0.40469549
  -0.96216911 -0.10287086 -0.06306221 -2.11537973  0.19065055 -2.65450876
  -1.90392809 -0.29667507  2.06603263  0.94757384  0.41935325  1.32559873
  -0.99505497 -0.93520936]
 [ 0.42728392 -0.87967879  0.97449994  0.40777875  1.65104641  0.34789668
   0.74710791 -1.89538445  1.34600886  0.09424939  0.06049019 -0.70063503
  -0.99717311  0.91128613 -1.53212637  2.05880785 -0.40579915  0.22009342
  -0.38958857  0.60295829]
 [-1.19694399 -0.66545138  0.70973323 -2.33905584  0.53093516  1.0627121
   1.00349416  0.95441802 -3.06106877  1.07340763  0.21989315 -0.5289878
  -0.75809198  0.9469734   0.55869225  1.39031424 -0.0370948  -1.71272894
  -1.32325411 -1.22267487]
 [-0.65044867 -0.53891292  1.40020733  0.66251779 -0.6380163  -1.50485989
  -0.87365336 -1.42743481  2.1616681   2.80246849 -1.98079552  0.30703623
   0.25276105 -2.27319263 -0.0495564  -0.76847281  1.25724316 -1.27967106
   1.06012766  0.06183053]
 [ 0.71017962  0.31910372 -0.2223488  -0.35593054 -1.50271937 -0.20196995
  -0.53825714 -1.01389227 -0.83210697  0.90012777 -1.02175247  0.35256581
  -0.44103455 -0.81027699  0.52121127  0.2876253  -0.49578445 -1.06770621
  -0.5342766   0.97609593]
 [ 0.39609365 -0.71345822 -0.34055405 -0.09180637  0.72760041 -2.84259059
   0.40194477  0.89639615  0.13942401 -0.02831875 -0.41745918  1.04478447
  -0.81827614  0.13557471  0.86782369  0.46970703  0.80518475  0.90116023
   0.43094642 -1.13669922]
 [-0.76917608 -0.63570215 -1.26997029  2.80523491 -0.21370715 -1.7052122
   0.27841372 -1.94070452  1.4860109   0.12181786 -2.07767727  1.60739187
   0.55725912 -0.52284957  0.90696583  1.9231739  -0.22005783  1.54188683
  -1.17844252 -0.16774327]
 [ 0.75754173  0.47001591 -0.53486843  0.79408097  1.74191974  1.42565238
  -0.21292938  0.58477423  0.29628707 -2.75694708  0.07506886 -1.2532481
  -0.66441413  0.23559374 -0.27873637 -0.91918264 -0.55091874 -0.22488662
  -0.45784265 -2.30918724]
 [ 0.82381346  1.63953354 -0.62852335 -1.16179979  1.18794452  1.29588785
  -0.04760705 -1.20094837 -1.39858864 -0.22587375  0.38312143  2.2630587
   2.00827859  1.07198016  0.72973986 -0.8210803   1.52315322  1.96480077
  -0.33033443 -0.68254131]
 [-1.39318662  0.17242933 -0.4399932  -0.63178762 -0.31141333  1.06683009
   0.26430697  0.45084102 -0.06120495  0.91914966  0.21777477  1.89952213
  -0.81540899  0.38771302 -1.46369898  0.57942339  0.71850957 -0.73619283
   0.27963436  1.81772604]]
[[ 0.35330223]
 [ 0.31212639]
 [ 1.7991155 ]
 [ 1.26438987]
 [-1.06468445]
 [-0.4525039 ]
 [-0.44021045]
 [-0.19146177]
 [ 0.90472196]
 [-0.62142686]]
before update, the grads are
[[-4.59462813e+00 -1.99093270e+00 -9.26010543e-01 -3.35445575e-02
  -4.13661105e+00 -7.63892961e+00 -5.07971404e+00 -2.78288815e+00
  -8.37893778e-01 -1.00195248e+00 -4.29499346e+00 -6.47584242e-01
  -3.24932124e+00 -5.55859713e-01 -5.62235986e+00 -5.63971231e-01
  -2.56747162e+00 -4.05908646e+00 -4.16241417e+00 -4.94524135e+00]
 [ 1.38270532e+00  6.24764151e-01 -3.23542969e-02 -2.96036834e-01
   1.26056036e+00  2.96622910e+00  1.91506954e+00  5.02181517e-01
   1.47072779e-01  1.45778457e-01  1.38151037e+00 -2.41168338e-02
   1.08211477e+00 -1.10441409e-01  2.00123109e+00 -7.23066833e-02
   8.89554947e-01  1.40518815e+00  1.61013186e+00  1.67447449e+00]
 [ 1.15234548e+00  7.26226032e-01  3.48351648e-03 -4.14117400e-01
   1.11846386e+00  3.10901610e+00  1.93136732e+00  3.79311314e-01
   8.42015719e-02  4.19175311e-02  1.19075524e+00 -5.62738499e-02
   1.55584398e+00 -1.66481409e-01  2.15369182e+00 -2.84777045e-01
   9.66295576e-01  1.49911959e+00  1.64157864e+00  1.83083070e+00]
 [ 2.53322850e-01  4.00822290e-01 -1.65486396e-01 -4.12087902e-01
   2.05408684e-01  1.79962040e+00  8.20672186e-01 -2.32374384e-01
  -2.76577440e-01 -2.91417842e-01  2.93634711e-01 -1.86974073e-01
   9.62941231e-01 -3.84683344e-01  1.35135865e+00 -4.22006225e-01
   3.96346931e-01  5.68273459e-01  5.46872889e-01  7.78125385e-01]
 [ 3.58423455e-01  2.49319299e-01  8.02731359e-02 -1.81734201e-02
   2.18819391e-01  8.58918973e-01  5.70068759e-01  1.39449948e-01
   2.21395443e-01  2.08159113e-01  3.22261830e-01  9.03333257e-02
   4.65831553e-01  9.46897717e-02  6.57301892e-01  3.19156415e-02
   2.84538549e-01  3.24435279e-01  4.00256698e-01  5.44985903e-01]
 [-2.92522939e+00 -4.33240789e-01  1.01241444e+00  1.23424789e+00
  -1.83241801e+00 -4.62453300e+00 -3.00879361e+00 -8.96831588e-01
   8.71778265e-01  5.62991996e-01 -1.99714980e+00  2.69997563e-01
  -1.10410911e+00  5.68089076e-01 -3.31388120e+00  6.46806486e-01
  -1.29580982e+00 -1.98011965e+00 -2.17284970e+00 -2.23149316e+00]
 [ 2.66511685e-01  2.57988998e-01  5.77967304e-01  4.83469183e-01
   4.55017119e-01  2.32980154e-01  4.11791222e-01  5.21394089e-01
   5.98762662e-01  5.06467897e-01  3.03360631e-01  4.22562044e-01
   3.93485150e-01  3.36913156e-01  2.37700843e-01  3.91157924e-01
   2.10628465e-01  4.67307743e-01  5.33394711e-01  4.95614842e-01]
 [ 2.11025245e-01  1.13904900e-01  2.06617333e-02 -2.15505229e-02
   1.84208282e-01  3.88650686e-01  2.78751048e-01  1.05685531e-01
   3.47794779e-02  2.63881564e-02  2.12876163e-01  2.12699404e-02
   1.40709348e-01 -2.05285816e-03  2.42784499e-01  1.29660082e-02
   1.34696489e-01  1.80743892e-01  2.45957854e-01  2.10193746e-01]
 [-4.02987953e-01 -2.76858395e-01 -1.59175705e+00 -1.55293860e+00
  -1.31454331e+00  2.42523113e-01 -4.50295731e-01 -1.48407639e+00
  -1.49959217e+00 -1.46942515e+00 -8.19973726e-01 -7.35106127e-01
  -4.22143117e-01 -1.05019899e+00  4.87031328e-02 -1.37036105e+00
  -1.33171877e-01 -1.29171273e+00 -1.23108711e+00 -1.10753944e+00]
 [-5.75068363e+00 -2.34529678e+00  2.52355273e+00  3.88107985e+00
  -3.54931828e+00 -1.38923899e+01 -7.77418640e+00 -5.14012777e-01
   1.96606353e+00  1.50521626e+00 -5.44808531e+00  1.38403059e+00
  -4.81192228e+00  1.83116552e+00 -9.17185308e+00  2.28041806e+00
  -3.91466699e+00 -4.25132344e+00 -4.54174350e+00 -6.52267046e+00]]
[[ -8.2794644 ]
 [  2.69536844]
 [  2.81629522]
 [  1.33403493]
 [  0.87291737]
 [ -3.79447642]
 [  0.77289392]
 [  0.39810722]
 [ -1.36478792]
 [-10.48354891]]
after update, the params are
[[ 0.63178381 -0.20762681 -0.61576992 -0.28414439  0.04909609 -0.39705656
  -0.9570894  -0.10008797 -0.06222432 -2.11437778  0.19494554 -2.65386117
  -1.90067877 -0.29611921  2.07165499  0.94813781  0.42192072  1.32965781
  -0.99089256 -0.93026412]
 [ 0.42590121 -0.88030355  0.97453229  0.40807479  1.64978585  0.34493045
   0.74519284 -1.89588663  1.34586179  0.09410361  0.05910868 -0.70061092
  -0.99825522  0.91139657 -1.5341276   2.05888016 -0.40668871  0.21868823
  -0.39119871  0.60128382]
 [-1.19809633 -0.66617761  0.70972975 -2.33864172  0.52981669  1.05960308
   1.00156279  0.95403871 -3.06115297  1.07336572  0.21870239 -0.52893153
  -0.75964782  0.94713988  0.55653856  1.39059902 -0.03806109 -1.71422806
  -1.32489569 -1.2245057 ]
 [-0.65070199 -0.53931374  1.40037282  0.66292988 -0.63822171 -1.50665951
  -0.87447403 -1.42720244  2.16194468  2.80275991 -1.98108915  0.30722321
   0.25179811 -2.27280794 -0.05090776 -0.76805081  1.25684681 -1.28023933
   1.05958079  0.0610524 ]
 [ 0.70982119  0.3188544  -0.22242907 -0.35591237 -1.50293819 -0.20282887
  -0.53882721 -1.01403172 -0.83232836  0.89991961 -1.02207473  0.35247548
  -0.44150038 -0.81037168  0.52055397  0.28759338 -0.49606899 -1.06803064
  -0.53467686  0.97555094]
 [ 0.39901888 -0.71302498 -0.34156647 -0.09304062  0.72943283 -2.83796606
   0.40495356  0.89729298  0.13855223 -0.02888175 -0.41546203  1.04451447
  -0.81717203  0.13500662  0.87113757  0.46906022  0.80648056  0.90314035
   0.43311927 -1.13446773]
 [-0.76944259 -0.63596014 -1.27054825  2.80475144 -0.21416217 -1.70544518
   0.27800193 -1.94122592  1.48541214  0.12131139 -2.07798063  1.60696931
   0.55686564 -0.52318649  0.90672813  1.92278274 -0.22026846  1.54141952
  -1.17897591 -0.16823888]
 [ 0.75733071  0.46990201 -0.53488909  0.79410252  1.74173553  1.42526373
  -0.21320813  0.58466855  0.29625229 -2.75697347  0.07485599 -1.25326937
  -0.66455484  0.2355958  -0.27897915 -0.9191956  -0.55105344 -0.22506736
  -0.45808861 -2.30939743]
 [ 0.82421645  1.6398104  -0.62693159 -1.16024685  1.18925906  1.29564532
  -0.04715676 -1.19946429 -1.39708904 -0.22440433  0.38394141  2.26379381
   2.00870073  1.07303036  0.72969115 -0.81970994  1.52328639  1.96609248
  -0.32910334 -0.68143377]
 [-1.38743594  0.17477462 -0.44251675 -0.6356687  -0.30786401  1.08072248
   0.27208116  0.45135503 -0.06317101  0.91764445  0.22322285  1.8981381
  -0.81059707  0.38588185 -1.45452713  0.57714297  0.72242423 -0.73194151
   0.28417611  1.82424871]]
[[ 0.3615817 ]
 [ 0.30943102]
 [ 1.79629921]
 [ 1.26305583]
 [-1.06555736]
 [-0.44870943]
 [-0.44098334]
 [-0.19185988]
 [ 0.90608675]
 [-0.61094331]]



in layer 3
this is Sigmoid layer
before update, the params are
before update, the grads are
after update, the params are



in layer 4
this is Linear layer
before update, the params are
[[ 1.76624593 -0.19868883 -0.56789373 -1.26471695 -0.2412356   1.22915682
  -1.63799489  0.30494083 -1.09165341  2.87083209]
 [-0.87691718  0.98118346  0.45961424 -0.1728095   0.53328846 -1.15278657
  -1.62912297  0.49142175  0.90989048 -1.06348949]
 [ 0.49429221 -1.02080849 -0.4581996  -0.03137672  0.78794525 -1.2587099
   0.11216647  0.45863964 -0.40553861  2.8780853 ]
 [ 0.02554449 -1.29198396  0.42358837 -0.72254469  0.19875153 -0.95386515
  -1.99581168 -0.02196062  1.56199074 -0.82907715]]
[[ 0.1417063 ]
 [ 1.53413066]
 [-1.08576747]
 [ 0.00322948]]
before update, the grads are
[[ -6.39098381  -6.59858924 -11.94702766  -0.56143544  -1.28134278
    1.19561966   1.9544247   -7.50250899 -14.70949031  -5.98620792]
 [  5.3063206    1.84331624   9.41707129  -3.30335484   0.98254313
   -4.21337715  -4.88367944   6.20198697   8.7022234    1.7762949 ]
 [  0.35023083   3.19612937   1.06288638   3.03700765   0.15144965
    2.32066945   2.40504756   0.51896449   3.62839885   2.87557074]
 [  0.73443238   1.55914363   1.46706998   0.82778263   0.14735
    0.69708804   0.52420718   0.78155753   2.37886806   1.33434229]]
[[-13.79932049]
 [  7.37219105]
 [  3.99591012]
 [  2.43121932]]
after update, the params are
[[ 1.77263691 -0.19209024 -0.55594671 -1.26415552 -0.23995426  1.2279612
  -1.63994932  0.31244334 -1.07694392  2.87681829]
 [-0.8822235   0.97934015  0.45019717 -0.16950614  0.53230591 -1.14857319
  -1.62423929  0.48521976  0.90118826 -1.06526579]
 [ 0.49394198 -1.02400462 -0.45926249 -0.03441373  0.7877938  -1.26103057
   0.10976143  0.45812068 -0.40916701  2.87520973]
 [ 0.02481006 -1.2935431   0.4221213  -0.72337247  0.19860418 -0.95456224
  -1.99633589 -0.02274218  1.55961188 -0.8304115 ]]
[[ 1.55505620e-01]
 [ 1.52675847e+00]
 [-1.08976338e+00]
 [ 7.98258624e-04]]
















The is AE
in layer 0
this is Linear layer
before update, the params are
[[-2.97441522e+00  9.03557451e-01  1.51561481e+00 -2.47894502e-01
   4.24605520e-01 -7.75109768e-01 -1.90313181e-02 -1.30339490e-01
  -1.56831692e+00  1.57507077e+00 -1.34320449e+00 -6.17064776e-01
  -1.92465899e+00 -5.16720149e-01  1.60446456e+00  1.36053066e+00]
 [ 6.16504750e-01  1.77025524e-01  6.24588060e-01 -4.31638375e-01
   1.60302008e+00 -5.42772013e-01  2.94135385e-01 -3.27996639e-01
  -1.07582853e+00 -8.75896499e-01 -5.85315895e-01  1.86710387e-01
  -8.72147529e-01 -7.12109411e-01  1.73802714e+00  1.16436564e-01]
 [ 1.50183307e+00 -6.12539389e-01  1.36258932e+00 -4.70778011e-01
   3.63448398e-02  2.13701428e-01 -2.39960651e-01 -1.42345632e-01
   1.10597193e+00  1.45651264e+00  3.91721198e-01 -1.62416026e+00
  -2.23457272e-01  1.70359872e+00 -2.44857857e-01 -2.57621435e-02]
 [ 4.98429177e-01 -8.84683755e-01  2.00685296e+00  3.84188239e-01
  -3.82545123e-01  2.69264111e-01 -7.21207033e-01  2.18520171e-01
  -4.74327439e-01 -7.29886169e-01  1.78963450e+00  2.16151594e-01
   6.29176589e-01  1.38060434e+00 -3.29353488e-01 -1.05741722e+00]
 [-4.82904860e-01  1.27934573e-01 -7.76629374e-01 -1.64466801e+00
  -1.91368577e-01 -1.76997417e+00 -1.04501264e+00 -1.37817204e+00
  -5.05516825e-01  8.25608268e-02 -2.31049751e-01  1.10146950e-01
  -2.82526078e-02 -2.00066923e+00 -9.04234847e-02  6.61833315e-01]
 [-6.08796649e-01 -6.95625878e-01 -8.58997436e-01  1.51705238e-01
   4.82345878e-01 -7.14977635e-01 -3.99459446e-01  2.48440095e-01
  -4.37539019e-01 -6.42302987e-02 -9.44705418e-01 -8.25777463e-04
   6.66008211e-01 -8.33997472e-01  1.84664652e+00 -1.32784252e+00]
 [ 1.53339005e+00  1.60354719e+00 -3.17586896e-01 -7.59367545e-01
  -2.85656098e-01  7.08459464e-01 -1.29890811e+00  6.38162278e-02
  -7.78445194e-01  2.42885038e-01  8.96469332e-01  1.76877011e+00
  -3.08880164e-01  1.26223440e-01  3.87981460e-01  1.66447581e-02]
 [ 4.51744535e-01  3.47981534e-01 -5.81547912e-01  1.62966351e+00
   2.78147362e-01  1.39852230e+00 -4.48636094e-01  4.44438214e-02
   1.97057186e+00 -8.70706856e-01 -9.76309466e-01 -1.99067300e+00
   1.34658390e+00  8.33289797e-01  8.27484701e-01  1.01015553e+00]
 [-7.94616798e-02  4.61138462e-01  1.53121907e-01  2.45711765e-01
  -1.87581831e+00  4.50397021e-01 -1.02891963e-01  3.51127296e-01
   7.33047958e-01  6.91421382e-01  3.38907199e-01  2.02297601e-01
   5.00612602e-01  3.41948512e-01 -6.29893675e-01  1.20538730e-01]
 [ 4.67749111e-01  6.82811005e-01 -2.96416204e-02  1.48606471e+00
  -1.61272490e+00  1.04019288e+00  1.63146895e+00 -9.80161829e-01
   1.95055646e-01 -1.15823524e+00  1.13503784e+00 -1.60587670e-01
  -3.64844395e-02 -4.00500639e-01 -5.87587088e-01 -1.61768996e+00]]
[[ 0.86286342]
 [-0.65008913]
 [ 2.1278583 ]
 [ 1.93964389]
 [ 0.50321931]
 [ 0.18809561]
 [ 0.09017754]
 [ 0.53004892]
 [ 1.47560124]
 [-1.10520832]]
before update, the grads are
[[ 18.16497517  -0.89048611  45.42646439 -21.46419858 -22.9470521
  -18.85695209  29.53168748  16.53583418  13.93725329  -8.93698488
   22.33175588  -5.59180953 -32.46917565 -14.81889087   6.56858918
    7.0111589 ]
 [ -3.81821087 -35.29650296   5.77734737  -1.32088073   2.35374588
   -7.67716718  -0.30036814  -5.55693187 -12.76397475 -23.90605053
  -10.61902505  -3.42105175  -3.5007179   21.58340328   7.57297533
  -12.19563593]
 [ 21.88691398 -11.04926432  13.82551597  -6.57836655 -11.67314758
  -10.45509334  20.69617584  19.82520841  15.38484136  -2.33734284
   -5.10192533 -12.25274016  -8.03369612  -8.38416038   8.38056469
   23.03997695]
 [ 28.67036388 -33.63267549  -1.47750103  -3.14739531 -35.88032992
  -46.95674512  18.5827323   23.4617559   36.14106987   7.51676007
  -76.07542701  -8.77382545 -10.2046346   -7.01969974 -15.64599833
   42.72465529]
 [ -6.55469921  14.49120244  -1.55952625  -6.99959878  -3.85972066
  -17.91021487 -21.67294451  -8.02980348  -3.97304869 -45.24990153
    3.22160715   7.11781081   3.67330429  -5.58570748   4.448421
   16.85938725]
 [ 14.55937146 -30.45802942   4.83753381 -17.31296566 -17.06673089
  -30.72255656  22.09780756  18.19088477  16.50609817  -7.13701662
   -7.34530986 -21.22357075 -21.60979024 -22.39469024  17.1155637
  -24.8128206 ]
 [-17.66379085  18.10592039 -20.12094534  17.20460003  22.29620929
   15.24184656 -25.38041098 -23.33726394 -17.13390975 -13.63647044
   -1.09041881  16.4230027   35.20230284  16.63273165 -17.84123905
  -30.17096179]
 [-22.95795627  23.86237098 -26.80628945  17.48084135  41.94425394
   26.81758532 -37.22749542 -37.81656243 -28.86408416  -2.5799556
   -6.61049334  20.4143657   54.02781102  21.50537261 -30.14527283
  -26.23431968]
 [ -5.14365902 -39.39029714 -12.12803224  13.24132651   8.73094975
  -25.19813196  15.87846543 -16.68621066 -41.13281555 -47.32302366
  -53.96194908  28.91654727  -9.13585442  24.53548748 -14.16063635
    4.97467685]
 [ 42.37719849 -40.37651998  76.11406347 -53.79752342 -72.20012965
  -38.56134446  65.29278401  62.1979579   21.9133135  -50.96662699
   32.52044751 -50.20460846 -72.33616554 -44.17760486  43.8298153
  -36.55682332]]
[[  4.57763279]
 [ 80.75868289]
 [ -6.34898258]
 [159.62867822]
 [ 72.30647826]
 [ 17.74459021]
 [ 17.99385338]
 [ -4.26358953]
 [228.76794393]
 [ 73.53691798]]
after update, the params are
[[-2.9925802   0.90444794  1.47018834 -0.2264303   0.44755257 -0.75625282
  -0.04856301 -0.14687532 -1.58225417  1.58400775 -1.36553625 -0.61147297
  -1.89218981 -0.50190126  1.59789597  1.3535195 ]
 [ 0.62032296  0.21232203  0.61881071 -0.43031749  1.60066633 -0.53509485
   0.29443575 -0.32243971 -1.06306456 -0.85199045 -0.57469687  0.19013144
  -0.86864681 -0.73369281  1.73045416  0.1286322 ]
 [ 1.47994615 -0.60149013  1.3487638  -0.46419964  0.04801799  0.22415652
  -0.26065683 -0.16217084  1.09058709  1.45884999  0.39682312 -1.61190752
  -0.21542358  1.71198288 -0.25323842 -0.04880212]
 [ 0.46975881 -0.85105108  2.00833046  0.38733563 -0.34666479  0.31622086
  -0.73978976  0.19505841 -0.51046851 -0.73740293  1.86570993  0.22492542
   0.63938122  1.38762404 -0.31370749 -1.10014187]
 [-0.47635016  0.11344337 -0.77506985 -1.63766841 -0.18750886 -1.75206396
  -1.02333969 -1.37014224 -0.50154378  0.12781073 -0.23427136  0.10302914
  -0.03192591 -1.99508353 -0.09487191  0.64497393]
 [-0.62335602 -0.66516785 -0.86383497  0.1690182   0.49941261 -0.68425508
  -0.42155725  0.23024921 -0.45404512 -0.05709328 -0.93736011  0.02039779
   0.687618   -0.81160278  1.82953096 -1.3030297 ]
 [ 1.55105384  1.58544127 -0.29746595 -0.77657214 -0.30795231  0.69321762
  -1.2735277   0.08715349 -0.76131128  0.25652151  0.89755975  1.7523471
  -0.34408247  0.10959071  0.4058227   0.04681572]
 [ 0.47470249  0.32411916 -0.55474162  1.61218266  0.23620311  1.37170471
  -0.4114086   0.08226038  1.99943594 -0.8681269  -0.96969897 -2.01108736
   1.29255609  0.81178442  0.85762997  1.03638984]
 [-0.07431802  0.50052876  0.16524994  0.23247044 -1.88454926  0.47559515
  -0.11877043  0.36781351  0.77418077  0.73874441  0.39286915  0.17338105
   0.50974846  0.31741302 -0.61573304  0.11556405]
 [ 0.42537191  0.72318752 -0.10575568  1.53986224 -1.54052477  1.07875423
   1.56617617 -1.04235979  0.17314233 -1.10726861  1.10251739 -0.11038306
   0.03585173 -0.35632303 -0.6314169  -1.58113313]]
[[ 0.85828579]
 [-0.73084781]
 [ 2.13420728]
 [ 1.78001521]
 [ 0.43091283]
 [ 0.17035102]
 [ 0.07218368]
 [ 0.53431251]
 [ 1.2468333 ]
 [-1.17874524]]



in layer 1
this is Sigmoid layer
before update, the params are
before update, the grads are
after update, the params are



in layer 2
this is Linear layer
before update, the params are
[[-0.38833697  0.71238828 -0.52472762  0.50906456  0.0122832  -1.51474849
   0.89849958  0.36512157  0.83969154 -0.76170156]
 [ 0.48076835 -1.26219571  0.1850136  -0.51891389 -1.77062385 -0.18644381
   1.81054536 -1.2396976   0.05368145  1.89368054]
 [-0.3071433  -0.27532352 -1.09115389  0.20846045  0.05500081  0.32080426
   0.97294743 -0.92101243 -0.13920171 -0.93341187]
 [-0.8929672  -0.67156859 -1.69340635  1.62715892  2.2823101  -0.11475408
   1.04676047  1.14622513  0.96785411  0.01171236]
 [ 0.09297566  0.41332148  0.67897774  1.96656022 -0.29884852  0.05108823
   0.46592695 -0.29385394  1.95352626  1.17741557]
 [ 0.04651297 -0.66722664 -0.91791883 -0.02262137  3.65032739  1.0963471
   1.08778824  0.06253164  0.02344789  0.17885752]
 [-0.02629148  1.99505318 -0.348688    0.18536945 -1.25731413 -0.23418252
   0.9828212   0.11908732  0.53921828 -0.86115654]
 [-0.81125587  0.93657075  0.88765689  0.87016486 -0.76251829 -0.89311679
  -0.29066786  0.54456573  0.20956554 -2.1447851 ]
 [ 0.45089635  0.84200594 -0.11271999  0.89756497 -0.69010721  0.8973141
  -1.7811368   0.07377795  3.43394462 -0.60903492]
 [ 2.24371292 -1.02056325 -0.87306432  0.05748698  1.24423877 -0.98477008
   0.64790168 -0.87756513  0.01585468  0.88908239]
 [ 0.74245041  0.05857141  1.45205527  1.21796027 -1.84950148 -1.5428995
   0.93454702  0.08016669  1.88151254  0.484249  ]
 [-2.62914864 -1.78176791  0.10558675 -0.42477194  0.63613477  0.36317753
   1.67443782  2.2487681  -1.12034391 -1.90852671]
 [ 0.50156104  0.69493637  0.78785907  0.3585915   0.82428078  1.20572964
  -0.81808086 -1.03871645 -0.08802724  0.49505779]
 [-1.6240696   0.56548212  1.41554826  0.96059118  0.18003298 -1.20168932
   0.31630472  0.16662879 -1.02868126 -0.33099663]
 [-0.13596345 -0.25833941 -0.01850728 -0.19674208  0.84583428 -0.5827613
  -1.15436299  0.85274982 -0.02759412 -3.59018191]
 [-0.87679426  1.0883509  -0.90417378 -0.52242408 -0.49767288  1.69286352
   0.18234115  1.04763397 -1.76247899  0.62513744]]
[[-1.33716234]
 [-0.78750626]
 [ 0.7752829 ]
 [ 0.7265722 ]
 [-1.93085879]
 [-0.16037641]
 [ 1.20831904]
 [ 0.60065971]
 [-0.47213049]
 [-1.3634929 ]
 [-0.43125073]
 [ 0.08409047]
 [-0.19786259]
 [ 1.27134854]
 [ 0.24234072]
 [ 0.06391152]]
before update, the grads are
[[ -52.05129872  -64.61463656 -100.80317918  -71.95824188  -70.04352097
   -74.59826029  -20.8334208   -55.92370538  -78.93900714  -43.69719141]
 [ -82.26430891  -68.05393168  -90.23261633  -81.23223994  -94.80474513
   -79.16960281  -57.64579729  -88.52023751  -92.638945    -26.88512045]
 [ -36.2415549   -35.16071116  -75.14750299  -29.83177807  -23.77618787
     8.38849799   20.9887816    -5.71374012  -36.64705392  -15.29983096]
 [ 142.91199794  111.28021228  190.76532209  227.83002811  177.64087269
   151.91502759  163.76942464  169.97749545  214.46883753  105.31734658]
 [ 107.31825221   79.56162689  174.31643469  159.03160139  107.01778161
    70.32764657   74.5740508    86.7512587   161.74910298   82.93832751]
 [ 124.00814469  112.13204981  140.11608922  139.14049863  170.24820203
   141.05267706   98.37159538  102.92791589  148.30127404   60.37681292]
 [  80.19009509   53.80497961   83.21968865  126.30767581   84.99181709
    93.70299716  106.26862381  110.10692092  108.83073102   51.22839131]
 [  15.42293219    3.04835086   20.05771814   34.84628038   11.94677594
    17.90874501   32.47518631   41.70123446   28.72190794    5.12252014]
 [ 119.53235684   81.26358962  148.96610531  160.50638001  108.31912541
   123.30837174   89.8820327   129.52572862  160.25415282   72.43409082]
 [ -26.62583213  -17.10210414  -76.6129287   -59.05205313  -25.90497781
   -60.30127942  -29.80252402  -79.04592701  -78.17845395  -25.08702579]
 [ 114.89991096   60.80480622  171.28442887  167.95849746   87.17448127
    82.06511256  100.21358952  145.57658206  177.86783118   74.73999672]
 [ -80.36974766  -61.69360901  -74.43167065  -79.4273486   -64.56179039
   -52.93196264  -31.43192111  -23.40905914  -70.54772938  -42.65075028]
 [  97.21382815   95.97273877  124.29012547   80.68725662   99.6577268
    76.54711326    6.86472719   32.60194111   86.90586273   40.26227076]
 [  36.18758866   55.71816787   98.88497952   80.38998973   71.76545416
    34.86842843   35.32183109   38.23984552   74.69776908   45.84178682]
 [ -46.71809496  -64.07340499  -70.81694648  -98.23605625  -59.48194507
   -68.74517756  -59.04634791  -44.83152932  -69.08350333  -77.67279057]
 [ -77.77471312  -14.0899639  -100.95924999  -37.83469374  -47.19312634
    33.82275247  -26.21448264  -24.79082028  -93.26960032    9.8380463 ]]
[[-111.99723888]
 [-130.35722522]
 [ -30.47265559]
 [ 295.97717354]
 [ 188.77045819]
 [ 209.8832131 ]
 [ 165.31961815]
 [  46.15380259]
 [ 220.97034032]
 [ -99.57060315]
 [ 221.18641759]
 [ -97.92714386]
 [ 118.62018361]
 [  96.13200344]
 [-107.4202628 ]
 [ -64.29810356]]
after update, the params are
[[-3.36285673e-01  7.77002916e-01 -4.23924443e-01  5.81022805e-01
   8.23267240e-02 -1.44015023e+00  9.19332998e-01  4.21045271e-01
   9.18630546e-01 -7.18004368e-01]
 [ 5.63032659e-01 -1.19414178e+00  2.75246220e-01 -4.37681650e-01
  -1.67581911e+00 -1.07274209e-01  1.86819116e+00 -1.15117737e+00
   1.46320390e-01  1.92056566e+00]
 [-2.70901740e-01 -2.40162811e-01 -1.01600639e+00  2.38292231e-01
   7.87769998e-02  3.12415760e-01  9.51958653e-01 -9.15298686e-01
  -1.02554659e-01 -9.18112038e-01]
 [-1.03587920e+00 -7.82848802e-01 -1.88417167e+00  1.39932889e+00
   2.10466922e+00 -2.66669107e-01  8.82991046e-01  9.76247630e-01
   7.53385271e-01 -9.36049840e-02]
 [-1.43425958e-02  3.33759854e-01  5.04661301e-01  1.80752862e+00
  -4.05866304e-01 -1.92394136e-02  3.91352895e-01 -3.80605201e-01
   1.79177716e+00  1.09447724e+00]
 [-7.74951708e-02 -7.79358686e-01 -1.05803492e+00 -1.61761870e-01
   3.48007919e+00  9.55294423e-01  9.89416647e-01 -4.03962768e-02
  -1.24853380e-01  1.18480710e-01]
 [-1.06481573e-01  1.94124820e+00 -4.31907693e-01  5.90617766e-02
  -1.34230595e+00 -3.27885516e-01  8.76552572e-01  8.98039519e-03
   4.30387548e-01 -9.12384933e-01]
 [-8.26678803e-01  9.33522400e-01  8.67599168e-01  8.35318579e-01
  -7.74465064e-01 -9.11025538e-01 -3.23143044e-01  5.02864493e-01
   1.80843631e-01 -2.14990762e+00]
 [ 3.31363997e-01  7.60742353e-01 -2.61686092e-01  7.37058587e-01
  -7.98426337e-01  7.74005732e-01 -1.87101883e+00 -5.57477836e-02
   3.27369047e+00 -6.81469007e-01]
 [ 2.27033875e+00 -1.00346115e+00 -7.96451387e-01  1.16539028e-01
   1.27014374e+00 -9.24468800e-01  6.77704201e-01 -7.98519204e-01
   9.40331309e-02  9.14169418e-01]
 [ 6.27550501e-01 -2.23339474e-03  1.28077084e+00  1.05000177e+00
  -1.93667596e+00 -1.62496462e+00  8.34333435e-01 -6.54098894e-02
   1.70364471e+00  4.09508999e-01]
 [-2.54877889e+00 -1.72007430e+00  1.80018418e-01 -3.45344591e-01
   7.00696560e-01  4.16109496e-01  1.70586974e+00  2.27217716e+00
  -1.04979618e+00 -1.86587596e+00]
 [ 4.04347212e-01  5.98963630e-01  6.63568949e-01  2.77904239e-01
   7.24623052e-01  1.12918252e+00 -8.24945590e-01 -1.07131839e+00
  -1.74933106e-01  4.54795516e-01]
 [-1.66025719e+00  5.09763954e-01  1.31666328e+00  8.80201189e-01
   1.08267521e-01 -1.23655775e+00  2.80982890e-01  1.28388940e-01
  -1.10337903e+00 -3.76838417e-01]
 [-8.92453518e-02 -1.94266010e-01  5.23096615e-02 -9.85060261e-02
   9.05316222e-01 -5.14016119e-01 -1.09531664e+00  8.97581352e-01
   4.14893811e-02 -3.51250912e+00]
 [-7.99019546e-01  1.10244086e+00 -8.03214528e-01 -4.84589391e-01
  -4.50479758e-01  1.65904076e+00  2.08555636e-01  1.07242479e+00
  -1.66920939e+00  6.15299393e-01]]
[[-1.2251651 ]
 [-0.65714903]
 [ 0.80575555]
 [ 0.43059503]
 [-2.11962924]
 [-0.37025963]
 [ 1.04299942]
 [ 0.5545059 ]
 [-0.69310083]
 [-1.2639223 ]
 [-0.65243714]
 [ 0.18201762]
 [-0.31648277]
 [ 1.17521653]
 [ 0.34976098]
 [ 0.12820963]]




Process finished with exit code 0
